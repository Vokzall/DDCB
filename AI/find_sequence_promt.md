# Задача: Оптимизация последовательности конфигураций программируемой линии задержки

## Контекст
Даны две таблицы задержек (для нарастающего и спадающего переходов) программируемой линии задержки. Каждая строка содержит:
- **Конфигурацию** (битовую маску выбора, длина зависит от архитектуры)
- **Полную задержку** в пикосекундах

## Требования к последовательности
Необходимо найти максимальную по длине последовательность конфигураций, удовлетворяющую следующим условиям:

### 1. Согласованность переходов
- Одинаковая конфигурация используется для обоих типов переходов (rise/fall) на каждом шаге

### 2. Постоянство шага задержки
- Задержки должны образовывать арифметическую прогрессию для каждого типа перехода отдельно
- **Параметр:** допустимая погрешность шага Δ_step (пс)
- Условие: |(T[n] - T[n-1]) - (T[n+1] - T[n])| ≤ Δ_step для всех n

### 3. Согласованность между переходами
- Разница задержек между rise и fall для одной конфигурации не должна превышать порог
- **Параметр:** максимальная разница Δ_rf (пс)
- Условие: |T_rise[k] - T_fall[k]| ≤ Δ_rf для всех k

### 4. Минимальное переключение (опционально)
- **Опция A (строгий код Грея):** между соседними конфигурациями изменяется ровно 1 бит
- **Опция B (ослабленный):** изменение до 2 бит между шагами
- **Опция C:** без ограничений на переключение бит

## Целевая функция
Максимизировать длину последовательности N при соблюдении условий.

## Выходные данные
Для найденной последовательности:
1. Массив задержек для rise: [T_rise[1], T_rise[2], ..., T_rise[N]]
2. Массив задержек для fall: [T_fall[1], T_fall[2], ..., T_fall[N]]
3. Соответствующие конфигурации (битовые маски)

## Особые случаи
- Если невозможно найти последовательность с Δ_step < X, можно постепенно увеличивать X
- Приоритет: длина последовательности > постоянство шага > минимальность переключения
- Допускается использование только "стабильных" конфигураций (где расчётное и фактическое число буферов совпадает), если такой параметр предусмотрен

## Пример параметров
```
Δ_step = 4 пс   # Допустимое отклонение от постоянного шага
Δ_rf   = 15 пс  # Максимальная разница между rise и fall
Режим переключения: опция A (строгий код Грея)
```

## Пример вывода результата

### Архитектура:
- 4 каскада, каждый с 3-входовым мультиплексором
- Управление: 2 бита на каскад (S0, S1 для этапов S0, S1, S2, S3)
- Варианты пути: 
  - `00` — 0 буферов (прямой путь)
  - `01` — 1 буфер
  - `10` — 2 буфера

### Найденная последовательность (5 шагов):

**Конфигурации (S0, S1, S2, S3):**
1. 00 00 00 00  (0x0000)
2. 01 00 00 00  (0x0400)
3. 01 01 00 00  (0x0500)
4. 01 01 01 00  (0x0540)
5. 01 01 01 01  (0x0541)

**Задержки Rise (пс):** [126, 158, 190, 222, 253]
**Задержки Fall (пс):** [118, 151, 183, 216, 247]

**Проверка условий:**
- Шаг Rise: 32, 32, 32, 31 пс (погрешность ≤1 пс)
- Шаг Fall: 33, 32, 33, 31 пс (погрешность ≤2 пс)
- Разница Rise-Fall: 8, 7, 7, 6, 6 пс (все ≤15 пс)
- Переключение: каждый шаг меняется ровно 1 бит (строгий код Грея)

**Итог:** Длина последовательности = 5 шагов.

